{% extends "base.html" %}

{% block content %}
<section class="content-section">
  <div class="container">
    <br>
    {% if user.is_authenticated %}
    {% if form.errors %}
      <div class="alert alert-warning">
        Your task description is too long.
      </div>
    {% endif %}
    <form class="form-group" action="." method="post">
      {% csrf_token %}
      <div class="input-group row">
        {% load home_extras %}
        {{ form.description|addcss:"form-control form-control-lg" }}
        <div class="input-group-append">
          <button class="btn btn-outline-primary" type="submit">Add Task</button>
        </div>
      </div>
    </form>
    {% for task in tasks %}
    <div class="form-group">
      <div class="input-group row">
        <input type="text" class="form-control form-control-lg" value="{{task.description}}" readonly>
        <div class="input-group-append">
          <div class="input-group-text">
            <input type="checkbox" onclick="window.location.href='{% url 'task_complete' task.id %}'">
          </div>
          <button type="button" class="btn btn-outline-secondary input-group-text dropdown-toggle dropdown-toggle-split" data-toggle="dropdown">
            <span class="sr-only">Toggle Dropdown</span>
          </button>
          <div class="dropdown-menu">
            <a class="dropdown-item" href="#">Reassign</a>
            <div role="separator" class="dropdown-divider"></div>
            <a class="dropdown-item" href="{% url 'task_delete' task.id %}">Delete</a>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
    {% if completed_tasks %}
    <div class="row">
      <p>
        <button class="btn btn-secondary" type="button" data-toggle="collapse" data-target="#collapseComplete">
          Show Completed
        </button>
      </p>
    </div>

    <div class="collapse" id="collapseComplete">
      {% for task in completed_tasks %}
      <div class="form-group">
        <div class="input-group row">
          <input type="text" class="form-control form-control-lg" value="{{task.description}}" readonly>
          <div class="input-group-append">
            <div class="input-group-text">
              <input type="checkbox" checked="checked" onclick="window.location.href='{% url 'task_not_complete' task.id %}'">
            </div>
            <button type="button" class="btn btn-outline-secondary input-group-text dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="sr-only">Toggle Dropdown</span>
            </button>
            <div class="dropdown-menu">
              <a class="dropdown-item" href="#">Delete</a>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% endif %}
    {% else %}
    <div class="text-center">
      <h1>Welcome to Simply Todo</h1>
      <h2><a href="{% url 'login' %}">Login</a> or <a href="{% url 'register' %}">register</a> to view your tasks.</h2>
      <br>
      <img src="https://msu.edu/_assets/images/homepage-heroes/spring-west-circle.JPG" class="img-fluid">
    </div>
    {% endif %}
  </div>
</section>
{% endblock %}